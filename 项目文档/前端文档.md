# 前端技术文档

本项目前端基于现代化的 Web 开发栈，采用单页应用 (SPA) 架构，深度集成响应式设计与角色权限控制。

## 🏗️ 架构概览

- **框架**: [React 18](https://reactjs.org/)
- **构建工具**: [Vite](https://vitejs.dev/)
- **样式**: [Tailwind CSS](https://tailwindcss.com/)
- **路由**: [React Router v6](https://reactrouter.com/)
- **图标**: [Heroicons](https://heroicons.com/)
- **图表**: [Recharts](https://recharts.org/)

## 🌳 组件与页面结构

### 1. 组件树 (Component Tree)
```text
App (Root)
├── Login (页面: 登录页)
├── Sidebar (组件: 侧边导航栏)
│   └── NavLink (路由链接)
├── Navbar (组件: 顶部导航栏)
└── Routes (路由容器)
    ├── Dashboard (页面: 工作台)
    │   └── StatCard (组件: 数据卡片)
    ├── Inventory (页面: 药品库存)
    │   ├── Modal (组件: 新增/编辑弹窗)
    │   └── Pagination (组件: 分页器)
    ├── Sales (页面: 销售开单)
    ├── InboundManagement (页面: 采购入库)
    ├── UserManagement (页面: 员工管理 - Admin)
    ├── CustomerManagement (页面: 客户管理)
    ├── SupplierManagement (页面: 供应商管理)
    ├── Reports (页面: 报表中心)
    ├── SalesAnalysis (页面: 销售分析)
    │   └── Recharts (第三方图表库)
    └── SystemMaintenance (页面: 系统维护 - Admin)
└── Toast (组件: 全局消息提示)
```

### 2. 核心页面功能详解

#### (1) 工作台 (Dashboard.jsx)
- **挂载逻辑** (`useEffect`): 页面加载时请求 `/api/dashboard/stats` 获取聚合数据。
- **展示内容**:
    - **KPI 卡片**: 总库存、月销售额、缺货药品数。
    - **Recharts 图表**: 最近 7 天销售趋势折线图、热销药品 Top5 柱状图。

#### (2) 药品库存 (Inventory.jsx)
- **状态管理**:
    - `medicines`: 药品列表数据。
    - `pagination`: 当前页码、每页条数。
    - `isModalOpen`: 控制新增/编辑弹窗的显隐。
- **交互逻辑**:
    - **搜索**: 监听输入框 `onChange` 事件，防抖后调用后端模糊搜索 API。
    - **编辑**: 点击编辑按钮填充表单数据到 `editingMedicine` 状态，切换 Modal 为编辑模式。

#### (3) 销售开单 (Sales.jsx)
- **业务流程**:
    1.  用户输入药品名/编码，后端返回匹配列表。
    2.  用户选择药品，系统自动填充单价。
    3.  输入数量，前端实时计算总价。
    4.  提交订单，成功后调用 `showToast` 提示并清空表单。
- **权限**: 所有员工可用。

#### (4) 销售分析 (SalesAnalysis.jsx)
- **高级功能**:
    - **多维度筛选**: 支持按日期范围、排序指标（销量/销售额/毛利）筛选。
    - **图表联动**: 切换筛选条件后，下方的折线图和排行表格自动更新。

## � 状态管理与持久化

### 全局状态 (`App.jsx`)
- **`currentUser`**: 存储当前登录用户的完整信息 (ID, Username, Role)。
- **`isLoggedIn`**: 布尔值，控制是否渲染登录页或主界面。
- **`toast`**: 全局消息对象 `{ message, type }`，用于跨组件通信触发提示。

### 本地存储 (localStorage)
系统在浏览器端持久化以下关键信息，确保刷新不丢失状态：
- `token`: 身份验证令牌 (JWT 或 Mock Token)。
- `currentUser`: 用户信息对象 JSON。
- `isLoggedIn`: 登录状态标识。

## 💡 开发习惯
- **组件化**：保持小而美的组件拆分原则。
- **响应式**：优先移动端适配，侧边栏在小屏下自动折叠为悬浮菜单。
